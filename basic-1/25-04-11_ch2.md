## 📖 네트워크의 기술  

📝 학습 내용    
### 1️⃣ TCP/IP    
  - **TCP/IP**: Internet Protocol Suite, 서로 다른 네트워크 장비들이 대화하기 위해 필요한 통신 프로토콜 세트  
  (이름과 달리 TCP, IP 외의 ICMP, UDP 등 다른 프로토콜도 포함)
  - TCP/IP 4계층 모델:  

    | 계층               | 주요 프로토콜      | 역할                                   | OSI 참조 모델에 대응|   
    |--------------------|-------------------|---------------------------------------| -------|
    | 응용 계층          | HTTPS, DNS       | 애플리케이션에 맞추어 통신            |  응용, 표현, 세션 계층 | 
    | 전송 계층          | TCP, UDP         | IP-어플리케이션 중개, 데이터 확실히 전달 | 전송 계층 |  
    | 인터넷 계층        | IP, ICMP, ARP    | 네트워크 주소를 기반으로 수신측에 데이터 전달 | 네트워크 계층 |  
    | 네트워크 접근 계층 | 이더넷, 무선 랜   | 네트워크에 물리적 연결                | 데이터 링크, 물리 계층 |

  - 데이터는 보낼 때 상위 -> 하위 계층 순으로, 받을 때 하위 -> 상위 계층 순으로 움직임
  - **IP 주소**: TCP/IP에 네트워크에 연결된 기기를 식별하기 위해 할당하는 번호
    - Global/Public IP: 인터넷에서 사용됨, Private IP: 로컬 네트워크에서 사용됨
  - **MAC 주소**: 제조 시부터 네트워크 기기에 할당된 고유 번호, 총 48비트, 데이터 링크 계층에서 사용됨
  - 동일한 네트워크에 속한 기기들이 서로 통신:  패킷 보낼 상대의 MAC 주소를 조사하고(ARP, 네트워크 전체에 해당 IP를 가진 기기의 MAC 주소 요청-해당 기기가 응답), 그 주소로 패킷 전송
  - 외부 네트워크의 기기와 통신: ARP로 기본 게이트웨이(라우터 또는 L3 스위치)에 대응하는 MAC 주소 요청
  - 패킷 - 회선 교환: 1대1로 통신하는 동안 회선 점유 vs 패킷 교환: 데이터를 패킷이라는 작은 단위로 쪼개고 내보내며 회선을 점유하지 않음 | Header: 운송장, Payload: 화물에 대응  
### 2️⃣ IP 주소 구조  
  - DHCP: 네트워크에 접속하기 위해 라우터에서 IP 주소를 자동으로 할당받음  
    1. DHCP Discover: DHCP 클라이언트가 서버를 찾기 위해 네트워크 통신
    2. DHCP Offer: 서버가 클라이언트에 네트워크 설정(클라이언트 IP 주소, 서브넷 마스크, 기본 게이트웨이 주소, DNS 서버 주소, 임대 시간 등) 제안
    3. DHCP Request: 클라이언트가 서버에게 설정의 세부 사항 요청  
    만일 여러 대의 서버가 설정 제안을 보냈다면 그 중 하나를 선택한 후 모든 DHCP 서버에게 클라이언트가 선택한 설정을 보냄
    4. DHCP ACK: 서버가 클라이언트에 설정의 세부 사항 지정, 자신이 클라이언트에 보낸 설정과 다른 설정값을 받은 DHCP 서버는 저장한 설정값 데이터 삭제
  - SRE(Site Reliability Engineering): 소프트웨어 엔지니어가 시스템 운용을 설계하는 방식
  - **서브넷 마스크**: IPv4 주소는 32자리(4개의 옥텟)의 2진수로 이루어져 있으며 네트워크 영역과 호스트 영역으로 나뉨 ➡️ 네트워크 영역이 어디까지인지 표시하는 방식
    > 🧮 예시  
    > IP 주소: 192.168.1.1 ➡️ 11000000.10101000.00000001.00000000  
    > 서브넷 마스크: 255.255.255.0 ➡️ 11111111.11111111.11111111.00000000  
    > 네트워크 주소: 192.168.1.0  (호스트 영역의 첫번째)  
    > 브로드캐스트 주소: 192.168.1.255  (호스트 영역의 마지막)
    > 총 256개의 주소 중 호스트 영역의 첫번째, 마지막 주소를 제외한 나머지 254개 주소 사용 가능  
  - **CIDR**: 네트워크 주소/서브넷 마스크의 비트 수 표기 ➡️ 192.168.1.0/24
  - IPAM: 네트워크 상의 IP 주소 관리 시스템
  - 서브넷 마스크의 네트워크 영역 길이에 따라 클래스 A(/8), 클래스 B(/16), 클래스 C(/24)로 나뉨
    - 가변 길이 서브넷 마스크: 서브넷 마스크 길이를 변경하여 네트워크 크기 변경  
    다만 호스트 영역이 너무 크면 브로드캐스트 통신량이 증가하므로 적절한 설정 필요
  - **라우팅 테이블**: 네트워크 통신을 어느 라우터로 전달해야 하는지 기록되어 있음, 정보가 없을 경우 기본 게이트웨이 / 정보가 있을 경우 특정 대상 라우터
  - 인터넷이나 대규모 네트워크의 경우 통신을 위해 여러 대의 라우터를 거쳐 가는 경우가 있음 | 라우터에도 기본 게이트웨이 (=기본 라우트) 존재
### 3️⃣ 네트워크 프로토콜
  - L2 스위치: MAC 주소에 따라 데이터 전송, 이전에는 리피터(증폭, 재전송 담당)를 사용했으나 비효율적이었음
  - L3 스위치: L2 스위치 + 다른 네트워크 연결 기능, 기기 간 연결이 많기 때문에 라우터보다 더 많은 포트 탑재
    - 라우터: L3 스위치 대비 다양한 (전화, 광 회선 등등) 회선 수용 가능, 송수신 일관성 검사, 위조 방지 등의 패킷 체크 보안 기능
  - L4, L7 스위치: 로드밸런서 - 서버 요청을 분산해서 통신량의 균형 조절
    - L4: TCP 등 프로토콜 헤더를 분석해서 라운드 로빈/최소 연결 등 알고리즘을 통해 분산 전송
    - L7: 응용 계층의 내용까지 분석, 분산 환경에서 세션 유지
  - 4계층의 프로토콜 - **TCP**: 신뢰성 있고 데이터 일관성 중요한 경우 / **UDP**å: 신뢰성 없고 속도, 실시간성 중요한 경우
    - 포트 번호: 동일한 대상 컴퓨터에서 실행되는 애플리케이션을 특정해서 인식  
    - Well-known port [0~1023]: 애플리케이션(서버)에서 사용
    - Registered port [1024~49151]: 독자적으로 만들어진 애플리케이션에서 사용
    - Dynamic port [49152~65535]: 애플리케이션(클라이언트)에서 사용
  - 3계층의 프로토콜 - ICMP: TCP/IP가 구현된 네트워크에서 네트워크 기기 사이의 통신 상태 확인 (ex. `ping`, `traceroute`)  
  - NAT(Network Address Translation): 랜 내에서 사용되는 private IP를 인터넷 상의 기기와 통신하기 위해 public IP로 변환하는 기술
  - private IP로 사용될 수 있는 주소의 범위는 총 3가지
    - 클래스 A: 10.0.0.0/8
    - 클래스 B: 172.16.0.0/12
    - 클래스 C: 192.168.0.0/16 
   - 라우팅 집약: 세부적인 네트워크 세그먼트를 더 큰 범위로 모아 라우팅 테이블 크기를 줄여 효율성 증가
   - 정적 라우팅: 네트워크 구축/구성 단계에서 대부분 수동으로 설정
   - 동적 라우팅: 라우터끼리 네트워크 접속 경로 정보를 공유하고 라우팅 프로토콜에 따라 라우팅 테이블 자동으로 설정, 대규모 네트워크에 적합

---
🔍 실습 / 테스트

  ```
  # ip, mac 주소 알아보기
  ifconfig en0
  # -> ether: mac addr / inet: ip addr
  
  # ping
  ping example.com
  ping 23.215.0.138
  
  # macOS에서 사용 중인 포트 찾기
  sudo lsof -iTCP -sTCP:LISTEN -n -P
  ```

---
❓ TCP/IP는 40년이 넘은 프로토콜 세트인데, 현재의 시선으로 보면 어떤 단점이 있을까? 또 어떤 개선 방향과 대안 기술이 나와있을까?

💡 TCP/IP는 신뢰 기반 네트워크를 대상으로 만들어졌기 때문에 그 자체에는 보안에 대한 기능이 부족함  
계층 수가 적어서 관리 주체가 모호해지는 경우가 있음  
IP 주소 체계 자체의 한계 (위치 기반, 주소량 부족 등등)  
무상태(Stateless)이기 때문에 상태 기반 제어 / 트래픽 예측이 어려움
계층마다 헤더 중첩으로 오버헤드 발생

💡 TCP/IP에 DNSSEC, TLS 등의 보안 기능 추가해서 사용  
UDP 기반으로 불필요한 라운드트립을 줄인 QUIC 프로토콜 사용 (구글 개발)
IP가 아닌 정보 중심 네트워크 (ICN) - 주소가 아닌 컨텐츠를 우선으로 찾는 NDN(CCN)
중앙 제어가 가능한 SDN

---
📚 참고자료

1. 『한 권으로 끝내는 네트워크 기초』, 오키타 토시야 지음, 길벗, 2022
2. [netmanias.com - DHCP 기본 동작 이해하기](https://www.netmanias.com/en/post/techdocs/5998/dhcp-network-protocol/understanding-the-basic-operations-of-dhcp)
---
💫 키워드

TCP/IP 프로토콜, IP 주소, DHCP, 서브넷 마스크, 라우팅, TCP, UDP, 


